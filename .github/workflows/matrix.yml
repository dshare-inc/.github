# a,b,c 형태의 Matrix를 JSON 형태로 반환한다.
#
name: '🍣 Matrix'

on:
  workflow_call:
    inputs:
      matrix:
        type: string
        required: true
        description: 'Matrix (string)'
    outputs:
      matrix:
        value: ${{ jobs.extract.outputs.result }}
        description: 'Matrix (JSON)'

jobs:
  extract:
    name: Extract the matrix
    runs-on: ubuntu-latest
    outputs:
      result: ${{ steps.extract.outputs.result }}
    steps:
      - name: Extract
        uses: actions/github-script@v5
        id: extract
        env:
          MATRIX: ${{ inputs.matrix }}
        with:
          result-encoding: string
          script: |
            if (MATRIX == null) {
              throw Error('Undefined matrix');
            }

            const { MATRIX } = process.env;

            return JSON.stringify({
              item: MATRIX.split(',').map(item => item.trim())
            })

